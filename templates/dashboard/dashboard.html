{% extends 'base/base.html' %}
{% load sitetree %}

{% block title %}
Dashboard
{% endblock %}

{% block extrajs %}


		<script type="text/javascript">



$( document ).ready(function() {
/////////////////////////////////////////////////1111////////////////////////////////////////////////////////////////////

var ctx1 = $('#chart_uno');

var myLineChart = new Chart(ctx1, {
    type: 'line',
    data: {
        labels: ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        datasets: [{
         label: "N° de Actividades Planificadas (Acumuladas)",

         data:  {{ ValMesesAcum }},

         borderColor: ['rgba(54, 162, 235, 1)'],
		 backgroundColor: ['rgba(240, 240, 240, 0)'],
		 pointBackgroundColor: "rgba(54, 162, 235, 1)",
		 pointBorderColor: "rgba(54, 162, 235, 1)",
		 pointHoverBackgroundColor:"rgba(52,108,176,1)",
		 pointHoverBorderColor: "rgba(52,108,176,1)",
   		 pointHoverBorderWidth: 2,
   		 pointHoverRadius:6,
		 borderWidth: 2,
		 pointBorderWidth:1,
		 pointRadius: 4
		},{

		 label: "N° de Actividades Ejecutadas (Acumuladas)",

         data: {{ ValMesesAcumEjec }},

         borderColor: ['rgba(255, 104, 136, 1)'],
		 backgroundColor: ['rgba(240, 240, 240, 0)'],
		 pointBackgroundColor: "rgba(255,104,136,1)",
		 pointBorderColor: "rgba(255,104,136,1)",
		 pointHoverBackgroundColor:"rgba(255,45,87,1)",
		 pointHoverBorderColor: "rgba(255,45,87,1)",
   		 pointHoverBorderWidth: 2,
   		 pointHoverRadius:6,
		 borderWidth: 2,
		 pointBorderWidth:1,
		 pointRadius: 4



        }]
     },
    options: {
			 title: {
					display: true,
					text: 'Curva de ejecución actividades programadas (acumulada)'
				},
	           legend: {
           		 display: true,


         		},


			   scales: {
				yAxes: [{
					ticks: {
						//suggestedMin: 0,
						//suggestedMax: 10,
						 beginAtZero: true,
					}
				}]
     		   },


    },

    plugins: [{
   afterDatasetsDraw: function(chart) {
      var ctx = chart.ctx;
      chart.data.datasets.forEach(function(dataset, index) {
         var datasetMeta = chart.getDatasetMeta(index);
         if (datasetMeta.hidden) return;
         datasetMeta.data.forEach(function(point, index) {
            var value = dataset.data[index],
                x = point.getCenterPoint().x,
                y = point.getCenterPoint().y,
                radius = point._model.radius,
                fontSize = 10,
                fontFamily = 'Verdana',
                fontColor = '#a0a0a0',
                fontStyle = 'normal';
            ctx.save();
            ctx.textBaseline = 'middle';
            ctx.textAlign = 'center';
            ctx.font = fontStyle + ' ' + fontSize + 'px' + ' ' + fontFamily;
            ctx.fillStyle = fontColor;
            ctx.fillText(value, x, y - radius - fontSize);
            ctx.restore();
         });
      });
   }
}]

});


$("#download").click(function(){
  /*Get image of canvas element*/
  var url_base64jp = document.getElementById("chart_uno").toDataURL("image/jpg");
  /*get download button (tag: <a></a>) */
  var a =  document.getElementById("download");
  /*insert chart image url to download button (tag: <a></a>) */
  a.href = url_base64jp;
});


   	 // JS modal actualiza Registro
   $(".update").each(function () {
   $(this).modalForm({formURL: $(this).data('id'),  modalID: $("#modalUpdate")});

    });

         // Js Muestra/Oculta Mensaje Success
   	 $(".alert").fadeTo(2000, 500).slideUp( "slow", function() {
     $(this).remove();
  });

});


		</script>
	{% endblock %}


{% block content %}

{% if messages %}
		  {% for message in messages %}

			<div style="border-radius:0;" {% if message.tags %} id="danger-alert" class="{{request.session.message_class}} fade show mb-0" role="alert" {% endif %}>
			  {{ message }}
			  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			  </button>
			</div>

		  {% endfor %}

	{% endif %}

<!--{{ request.session.grupo }}-->
<!--<div class="row"></div>-->




<div class="col-md-12">
<section class="panel">
		<header class="panel-heading">
			<div class="panel-actions">
<!--				<button type="button" class="create btn btn-sm btn-success" name="button">-->
<!--					<span class="fa fa-plus"></span>-->
<!--				</button>-->
<a id="download" style="width:30px; height:30px;"  name="download"  download="Curva_de_ejecucion_actividades_programadas.jpg" href="" class="btn btn-sm btn-success" title="Descargar Gráfico" data-toggle="tooltip" data-original-title="Tooltip on bottom" data-placement="top">
<span style="margin-left:-2px;" class="fa fa-download"></span>
</a>

			</div>

		<h2 class="panel-title">Gráfico</h2>
		</header>

		<div class="panel-body">


<canvas id="chart_uno" >

</canvas>

		</div>


</section>


</div>






	{% endblock %}
